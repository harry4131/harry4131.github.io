<!DOCTYPE html>
<html lang="en">
<head>
  
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Image Compressor ‚Äì Tech Harry</title>

<link rel="stylesheet" href="../css/style.css">
</head>

<body>

<video autoplay muted loop playsinline id="bg-video">
  <source src="../assets/bg1.mp4" type="video/mp4">
</video>

<header class="navbar">
    <a href="image-tools.html">‚Üê Back</a>
  <a href="..\index.html">Home</a>

</header>

<section class="tool-container">

  <h2>Image Compressor</h2>
  <p class="tool-desc">Reduce image file size without quality loss.</p>

  <div class="upload-box">
    <p>üñºÔ∏è Drag & Drop Image</p>
    <span>or</span><br><br>
    <input type="file" id="fileInput" accept="image/*">
  </div>

  <div class="preview-list" id="previewList"></div>

  <div class="progress-bar">
    <div id="progress"></div>
  </div>

  <button class="action-btn" id="actionBtn" disabled>
    Compress Image
  </button>

  <a id="downloadBtn" class="download-btn" style="display:none;">
    Download Image
  </a>

</section>

<script>
const input = document.getElementById("fileInput");
const preview = document.getElementById("previewList");
const progress = document.getElementById("progress");
const actionBtn = document.getElementById("actionBtn");
const downloadBtn = document.getElementById("downloadBtn");

let originalFile = null;
let compressedBlob = null;

input.addEventListener("change", () => {
    originalFile = input.files[0];
    if (!originalFile) return;

    preview.innerHTML = `
        Original: ${(originalFile.size / 1024 / 1024).toFixed(2)} MB
    `;

    progress.style.width = "0%";
    downloadBtn.style.display = "none";
    actionBtn.disabled = false;
});

actionBtn.addEventListener("click", () => {
    if (!originalFile) return;

    progress.style.width = "10%";

    const img = new Image();
    const imgURL = URL.createObjectURL(originalFile);
    img.src = imgURL;

    img.onload = () => {

        // ‚úÖ REAL COMPRESSION SETTINGS
        const MAX_WIDTH = 1280;
        const MAX_HEIGHT = 1280;
        const QUALITY = 0.65;

        let width = img.width;
        let height = img.height;

        if (width > MAX_WIDTH || height > MAX_HEIGHT) {
            const ratio = Math.min(
                MAX_WIDTH / width,
                MAX_HEIGHT / height
            );
            width = Math.round(width * ratio);
            height = Math.round(height * ratio);
        }

        progress.style.width = "40%";

        const canvas = document.createElement("canvas");
        canvas.width = width;
        canvas.height = height;

        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0, width, height);

        progress.style.width = "70%";

        canvas.toBlob(blob => {
            compressedBlob = blob;

            progress.style.width = "100%";

            const newSize =
                (blob.size / 1024 / 1024).toFixed(2);

            preview.innerHTML += `
                <br>Compressed: ${newSize} MB
            `;

            downloadBtn.href = URL.createObjectURL(blob);
            downloadBtn.download = "compressed-image.jpg";
            downloadBtn.style.display = "inline-block";

            URL.revokeObjectURL(imgURL);

        }, "image/jpeg", QUALITY);
    };
});
</script>


<footer class="main-footer">

  <div class="footer-links">
    <a href="../pages/about.html">About</a>
    <a href="../pages/contact.html">Contact</a>
    <a href="../pages/privacy.html">Privacy Policy</a>
    <a href="../pages/terms.html">Terms & Conditions</a>
    <a href="../pages/disclaimer.html">Disclaimer</a>
    <a href="../pages/cookies.html">Cookie Policy</a>

  </div>

  <p>¬© <span id="year"></span> Tech Harry. All rights reserved 2026.</p>

</footer>

<script>
document.getElementById("year").textContent = new Date().getFullYear();
</script>
<script src="/js/darkmode.js"></script>

</body>
</html>
