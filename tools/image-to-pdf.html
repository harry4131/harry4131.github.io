<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Image to PDF ‚Äì Tech Harry</title>

<link rel="stylesheet" href="../css/style.css">

<script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

</head>

<body>

<video autoplay muted loop playsinline id="bg-video">
  <source src="../assets/pdf.mp4" type="video/mp4">
</video>

<header class="navbar">
  <a href="pdf-tools.html">‚Üê Back</a>
  <a href="../index.html">Home</a>
</header>

<section class="tool-container">

<h2>Image to PDF</h2>
<p class="tool-desc">Convert images into a single PDF.</p>

<div class="upload-box" id="dropZone">
  <p>üñºÔ∏è Drag & Drop Images</p>
  <span>or</span><br><br>
  <input type="file" id="fileInput" multiple accept="image/*">
</div>

<div class="preview-list" id="previewList"></div>

<div class="progress-bar">
  <div id="progress"></div>
</div>

<button class="action-btn" id="actionBtn" disabled>
  Convert to PDF
</button>

<a id="downloadBtn" class="download-btn" style="display:none;">
  Download PDF
</a>

</section>

<script>
const { PDFDocument } = PDFLib;

const input = document.getElementById("fileInput");
const button = document.getElementById("actionBtn");
const progress = document.getElementById("progress");
const downloadBtn = document.getElementById("downloadBtn");
const previewList = document.getElementById("previewList");

let images = [];

/* ADD MULTIPLE IMAGES */
input.addEventListener("change", () => {
  const files = Array.from(input.files);

  files.forEach(file => {
    images.push(file);

    const img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    img.style.height = "90px";
    img.style.margin = "8px";
    img.style.borderRadius = "6px";

    previewList.appendChild(img);
  });

  input.value = "";
  button.disabled = images.length === 0;
});

/* CONVERT TO PDF ‚Äî A4 SEPARATE PAGES */
button.addEventListener("click", async () => {

  progress.style.width = "0%";
  downloadBtn.style.display = "none";

  const pdf = await PDFDocument.create();

  // A4 size in points
  const PAGE_WIDTH = 595.28;
  const PAGE_HEIGHT = 841.89;

  for (let i = 0; i < images.length; i++) {

    const bytes = await images[i].arrayBuffer();

    let image;
    if (images[i].type === "image/png") {
      image = await pdf.embedPng(bytes);
    } else {
      image = await pdf.embedJpg(bytes);
    }

    const imgWidth = image.width;
    const imgHeight = image.height;

    const scale = Math.min(
      PAGE_WIDTH / imgWidth,
      PAGE_HEIGHT / imgHeight
    );

    const drawWidth = imgWidth * scale;
    const drawHeight = imgHeight * scale;

    const x = (PAGE_WIDTH - drawWidth) / 2;
    const y = (PAGE_HEIGHT - drawHeight) / 2;

    const page = pdf.addPage([PAGE_WIDTH, PAGE_HEIGHT]);

    page.drawImage(image, {
      x,
      y,
      width: drawWidth,
      height: drawHeight
    });

    progress.style.width =
      ((i + 1) / images.length) * 100 + "%";
  }

  const pdfBytes = await pdf.save();

  const blob = new Blob([pdfBytes], {
    type: "application/pdf"
  });

  downloadBtn.href = URL.createObjectURL(blob);
  downloadBtn.download = "images.pdf";
  downloadBtn.style.display = "inline-block";
});
</script>

<footer class="main-footer">

<div class="footer-links">
  <a href="../pages/about.html">About</a>
  <a href="../pages/contact.html">Contact</a>
  <a href="../pages/privacy.html">Privacy Policy</a>
  <a href="../pages/terms.html">Terms & Conditions</a>
  <a href="../pages/disclaimer.html">Disclaimer</a>
  <a href="../pages/cookies.html">Cookie Policy</a>
</div>

<p>¬© <span id="year"></span> Tech Harry. All rights reserved 2026.</p>

</footer>

<script>
document.getElementById("year").textContent =
  new Date().getFullYear();
</script>

<script src="/js/darkmode.js"></script>

</body>
</html>
